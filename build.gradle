plugins{
    id 'groovy'
    id 'wrapper'
    id 'java-gradle-plugin'
}

def integrationTest = sourceSets.create("integrationTest")

repositories {
    mavenCentral()
}


dependencies {
    implementation 'org.codehaus.groovy:groovy-all:2.4.15'
    testImplementation 'junit:junit:4.13'
    testRuntimeOnly "org.junit.vintage:junit-vintage-engine:5.8.2"
    integrationTestImplementation gradleTestKit()
    integrationTestImplementation 'junit:junit:4.13'
    integrationTestRuntimeOnly "org.junit.vintage:junit-vintage-engine:5.8.2"
}

gradleEnterprise {
    buildScan {
        termsOfServiceUrl = "https://gradle.com/terms-of-service"
        termsOfServiceAgree = "yes"
        // publishAlways()
    }
}

gradlePlugin {
    plugins {
        simplePlugin {
            id = 'org.boblloyd.GradleProjectReport'
            implementationClass = 'org.boblloyd.gradleprojectreport.ProjectReport'
        }
    }
    testSourceSets sourceSets.integrationTest
}

tasks.register('integrationTest', Test) {
    description = 'Runs integration tests.'
    group = 'verification'

    testClassesDirs = sourceSets.integrationTest.output.classesDirs
    classpath = sourceSets.integrationTest.runtimeClasspath
}

tasks.withType(Test).configureEach {
    useJUnitPlatform()
}

check.dependsOn "integrationTest"